/*!
 * LastModifyTime: Sun Aug 09 2015 21:45:16 GMT+0800 (CST)
 * Process.js Version: 0.0.6
 * Github:https://github.com/Lucifier129/process
 * Copyright(c) 2015 Jade Gu <guyingjie129@163.com>
 * MIT Licensed
 */
!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&(define.amd||define.cmd)?define(r):"object"==typeof exports?exports.Process=r():t.Process=r()}(this,function(){function t(t,r){a(this,t),this.state=a(this.state||{},r)}var r=function(t){return t="[object "+t+"]",function(r){return null!=r&&Object.prototype.toString.call(r)===t}},e=r("Object"),n=r("String"),i=r("Number"),o=r("Function"),u=Array.isArray||r("Array"),c=function(t){return null!=t&&o(t.then)},s=Array.prototype.slice,a=function(t){for(var r=s.call(arguments,1),n=0,i=r.length;i>n;n++){var o=r[n];if(e(o))for(var u in o)o.hasOwnProperty(u)&&(t[u]=o[u])}return t};return t.prototype={extend:function(){return a.apply(null,[this].concat(s.call(arguments)))},setState:function(){return a.apply(null,[this.state].concat(s.call(arguments)))},resolve:function(t,r){return this.dispatch(this[t],r)},reject:function(r,n){var i=this.error;return this.$error instanceof t?e(i)&&this.$error.extend(i):this.$error=new t(i),this.$error.resolve(r,n)},willResolve:function(t,r){var e=this;return function(n){return e.resolve(t,n||r)}},willReject:function(t,r){var e=this;return function(n){return e.reject(t,n||r)}},dispatch:function(t,r){if(null===r)return r;var s=this;if(o(t))return t.call(s,r,s.state,s);if(n(t)||i(t))return s.dispatch(s[t],r);if(u(t))for(var a=0,f=t.length;f>a;a++){if(r=s.dispatch(t[a],r),null===r)return r;if(c(r))return a===f-1?r:r.then(function(r){return s.dispatch(t.slice(a+1),r)})}else{if(c(t))return t.then(function(t){return s.dispatch(t,r)});if(e(t)&&o(t.goTo))return s.dispatch(t.goTo(r,s.state,s),r)}return r}},t});