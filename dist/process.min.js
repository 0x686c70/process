!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&(define.amd||define.cmd)?define(r):"object"==typeof exports?exports.Process=r():t.Process=r()}(this,function(){function t(t){this.store=c({},t)}var r=function(t){return function(r){return null!=r?Object.prototype.toString.call(r)==="[object "+t+"]":!1}},e=r("Object"),n=r("String"),o=r("Function"),i=Array.isArray||r("Array"),u=function(t){return null!=value&&o(value.then)},c=function(t){for(var r=Array.prototype.slice.call(arguments,1),n=0,i=r.length;i>n;n+=1){var u=r[n];if(e(u)||o(u))for(var c in u)u.hasOwnProperty(c)&&(t[c]=u[c])}return t};return t.prototype={extend:function(){return c.apply(null,[this.store].concat(Array.prototype.slice.call(arguments)))},resolve:function(t,r){return this.dispatch(this.store[t],r)},reject:function(r,e){return new t(this.store.error).resolve(r,e)},willResolve:function(t){var r=this;return function(e){return r.resolve(t,e)}},willReject:function(t){var r=this;return function(e){return r.reject(t,e)}},dispatch:function(t,r){if(o(t))return t(r);if(n(t))return this.resolve(t,r);if(i(t))return this.pipe(t,r);if(e(t))return this.transform(t,r);if(u(t)){var c=this;return t.then(function(t){return c.dispatch(t,r)})}return r},pipe:function(t,r){for(var e=r,n=0,o=t;o>n;n+=1){if(r=this.dispatch(t[n],r),u(r)){var i=this;return r.then(function(r){return i.pipe(t.slice(n+1),r)})}if(null===r)return e}return r},transform:function(t,r){return o(t.goTo)?this.dispatch(t.goTo(r),r):r}},t});